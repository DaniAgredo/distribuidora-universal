<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distribuidora Universal</title>

<link rel="stylesheet" href="/static/style.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>

<!-- ========= HEADER ========= -->
<header class="header">
  <div class="fila-superior">

    <!-- IZQUIERDA: LOGO + NOMBRE -->
    <div class="titulo">
      <span class="icono">&#127757;</span>
      <div class="nombre">
        DISTRIBUIDORA UNIVERSAL DE POPAYÁN S.A.S
        <small>Tiendas de Mercancía General, incluyendo Grandes Almacenes</small>
        <small>NIT: 900779615-8 Popayán-Cauca &#10024; Colombia</small>
      </div>
    </div>

    <!-- DERECHA: TIENDA + LOGIN -->
    <div class="acciones">
      <a href="https://wa.me/573215485315" class="whatsapp" target="_blank" rel="noopener">
        <i class="fa-brands fa-whatsapp"></i>
        <span class="whatsapp-saludo">WhatsApp</span>
      </a>
      <a href="/conocenos" class="nosotros">Conócenos</a>
      <a href="#" class="login"><i class="fa-solid fa-user login-icon"></i> <span class="login-text">Cuenta</span></a>
      <a href="#" class="logout-header">Salir</a>
      <a href="#" class="modo-nocturno" aria-label="Modo nocturno">
        <i class="fa-solid fa-moon"></i>
      </a>
    </div>

  </div>

  <!-- FILA INFERIOR -->
  <div class="fila-inferior">
    <div class="franja-movimiento">
      &#127760; CARRERA 5 # 7-13 BARRIO CENTRO &#128205; Popayán, Cauca — &#128338; horario de atención de Lunes a Sábado 8:00 AM – 4:00 PM — &#128230; Variedad real para hogares, negocios y campo...
    </div>
  </div>

</header>



<!-- ========= BANNER ========= -->
<section class="banner">

    <div class="banner-contenido">

        <!-- COLUMNA IZQUIERDA -->
        <div class="banner-info">
           <div class="saludo-banner" aria-live="polite">
             <span class="saludo-banner-line">¡Bienvenido!</span>
             <span class="saludo-banner-text">Estamos listos para tu pedido.</span>
           </div>
           <div class="ruta-banner" aria-live="polite">
             <span class="ruta-title">Rutas para tu zona</span>
             <span class="ruta-text">El carro va martes y viernes. Actualizamos esta info cada semana.</span>
           </div>
           <a href="#" class="tienda"><i class="fa-solid fa-cart-shopping tienda-icon"></i> Tienda Virtual</a>
        

            <!-- BOTON CATEGORIAS -->
    <div class="buscador-categorias">
            <div class="dropdown">
                <button class="btn-categorias">&#9776;</button>

                <div class="dropdown-contenido">
                    <a href="/drogueria">&#128138; Droguería</a>
                    <a href="/aseo">&#129529; Aseo</a>
                    <a href="/ferreteria">&#128295; Ferretería</a>
                    <a href="/papeleria">&#128213; Papelería</a>
                    <a href="/jabones">&#129530; Varios</a>
                </div>
            </div>

             <!-- BUSCADOR -->
        <input class="buscador" type="text" placeholder="Buscar productos...">
           <!-- FRANJA METODOS DE PAGO -->
     </div>
    </div>
    
    <div class="mapa">
            <iframe
              src="https://www.google.com/maps?q=Popayan+Cauca+Carrera+5+7-13&output=embed"
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade">
            </iframe>
            <a
              class="mapa-link-btn"
              href="https://www.google.com/maps?q=Popayan+Cauca+Carrera+5+7-13"
              target="_blank"
              rel="noopener"
            >
              Ver mapa en Google
            </a>
        </div>
    </div>
    </section>


 <div class="franja-pagos">
  <div class="marquee-pagos">
    <span>&#128179; Recibimos todos los métodos de pago</span>

    <img src="/static/images/nequi.png">
    <img src="/static/images/bancolombia.png">
    <img src="/static/images/davivienda.png">
    <img src="/static/images/efectivo.png">
    <img src="/static/images/pse.png">
    <span>"Llevamos tu pedido a todo el departamento" &#128666; - Piendamó - Morales - Suárez - Silvia - Totoró - Timbío - Paispamba - Coconuco - La Sierra - El Bordo - Sucre - Bolívar - Mercaderes - Balboa - Argelia - Plateado - El Tambo - Huisitó - Bienvenido a tu cacharro de confianza</span>
  </div>
</div>


<section class="slider-section">
    <!-- COLUMNA Promocion productos -->
        <div class="slider">
            <img src="/static/images/banner1.jpg" class="slide activo" loading="eager" decoding="async">
            
            <img src="/static/images/banner2.jpg" class="slide" loading="lazy" decoding="async">
            
            <img src="/static/images/banner3.jpg" class="slide" loading="lazy" decoding="async">
  
            <img src="/static/images/banner4.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner5.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner6.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner7.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner8.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner9.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner10.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner11.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner12.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner13.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner14.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner15.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner16.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner17.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner18.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner19.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner20.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner21.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner22.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner23.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner24.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner25.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner26.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner27.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner28.jpg" class="slide" loading="lazy" decoding="async">
            <img src="/static/images/banner29.jpg" class="slide" loading="lazy" decoding="async">
           <img src="/static/images/banner30.jpg" class="slide" loading="lazy" decoding="async">
        </div>
</section>

           <!-- MENSAJES DE NEGOCIO -->
<section class="mensajes-negocio">

    <p class="mensaje activo">¡Todo para tu negocio en un solo lugar!</p>
    <p class="mensaje">¡Calidad, confianza y excelente atención!</p>
    <p class="mensaje">Atendemos negocios de toda la región.</p>
    <p class="mensaje">Pedidos fáciles por WhatsApp.</p>
    <p class="mensaje">¡Hogar, Oficina, Escuela, Pesca, campo y hasta más!</p>
    <p class="mensaje">¡Lo básico y lo que no sabías que necesitabas!</p>
    <p class="mensaje">....Distribuidora Universal, tu aliado comercial...</p>
  


</section>
<!-- ===== MARCAS ===== -->
<section class="marcas">

    <h2 class="titulo-seccion">Marcas estratégicas</h2>

    <div class="marcas-grid">

        <div class="marca-item">
            <img src="/static/images/marcas/norma.png" alt="norma">
        </div>

        <div class="marca-item">
            <img src="/static/images/marcas/primavera.png" alt="Primavera">
        </div>

        <div class="marca-item">
            <img src="/static/images/marcas/colgate.png" alt="colgate">
        </div>

        <div class="marca-item">
            <img src="/static/images/marcas/winny.png" alt="Winny">
        </div>

        <div class="marca-item">
            <img src="/static/images/marcas/genfar.png" alt="genfar">
        </div>
        <div class="marca-item">
            <img src="/static/images/tecnoquimicas.jfif" alt="Tecnoquímicas">
        </div>

    </div>

</section>

<div class="franja-azul"></div>
<footer class="footer">
  <div class="footer-contenido">

    <!-- CENTRO DE AYUDA -->
    <div class="footer-col">
      <h4>Centro de ayuda</h4>
      <div class="footer-ayuda">
        <a class="ayuda-link" href="/envios">Envíos y entregas</a>
        <a class="ayuda-link" href="/devoluciones">Cambios y devoluciones</a>
        <a class="ayuda-link" href="/pagos">Métodos de pago</a>
        <a class="ayuda-link" href="javascript:void(0)">Preguntas frecuentes</a>
        <a class="ayuda-link" href="javascript:void(0)">Términos y condiciones</a>
        <a class="ayuda-link" href="javascript:void(0)">Políticas de privacidad</a>
      </div>
    </div>

    <!-- UBICANOS -->
    <div class="footer-section">
      <h4>Ubícanos</h4>
      <p>
        Carrera 5 # 7-13 Barrio Centro<br>
        <a
          href="https://www.google.com/maps?q=Popayan+Cauca+Carrera+5+7-13"
          target="_blank"
          class="map-link"
          rel="noopener"
        >
          &#128205; Popayán - Cauca · Cómo llegar
        </a><br>
        &#128242; 321 548 5315<br>
        Distriuniversal@gmail.com
      </p>
    </div>

    <!-- ESCRIBENOS -->
    <div class="footer-section" id="contacto">
      <h4>Escríbenos</h4>
      <input type="email" placeholder="Tu correo" class="footer-input">
      <textarea placeholder="Escribe tu mensaje..." class="footer-textarea"></textarea>
      <button class="footer-btn">Enviar</button>
    </div>

    <!-- REDES SOCIALES -->
    <div class="footer-section">
      <h4>Síguenos</h4>
      <div class="socials">
        <a href="#"><i class="fab fa-facebook-f"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
        <a href="#"><i class="fab fa-whatsapp"></i></a>
      </div>
    </div>

  </div>

  <div class="back-to-top" onclick="window.scrollTo({top:0, behavior:'smooth'})">
    &#8593;
  </div>

  <div class="footer-final">
    <div class="brand">
      © 2026 DISTRIBUIDORA UNIVERSAL S.A.S Colombia ® · Todos los derechos reservados
    </div>
  </div>
</footer>



<!-- ========= MODAL CUENTA ========= -->
<div class="login-modal" id="loginModal" aria-hidden="true">
  <div class="login-overlay" data-close="login"></div>
  <div class="login-sheet" role="dialog" aria-modal="true" aria-labelledby="loginTitle">
    <button class="login-close" type="button" aria-label="Cerrar">×</button>
    <div class="login-header">
      <h3 id="loginTitle">Cuenta Distribuidora</h3>
      <p>Accede o registra tu negocio para pedidos r&aacute;pidos.</p>
      <div class="login-greeting" aria-live="polite">
        <span class="greet-line">Bienvenido</span>
        <span class="greet-sub">Estamos listos para tu pedido.</span>
      </div>
    </div>
    <div class="login-tabs">
      <button type="button" class="login-tab active" data-tab="login">Iniciar sesi&oacute;n</button>
      <button type="button" class="login-tab" data-tab="registro">Registrarse</button>
    </div>

    <div class="login-panel active" data-panel="login">
      <form class="login-form" id="loginForm">
        <label>Correo</label>
        <input type="email" name="correo" placeholder="correo@negocio.com" required>
        <label>Contrase&ntilde;a</label>
        <input type="password" name="password" placeholder="••••••••" required>
        <button type="submit" class="btn-primary">Ingresar</button>
      </form>
      <div class="login-divider">o</div>
      <div class="login-social">
        <button type="button" class="btn-social facebook">Continuar con Facebook</button>
        <button type="button" class="btn-social qr">Ingresar con QR</button>
      </div>
      <div class="qr-panel" id="qrPanel">
        <div class="qr-box" aria-hidden="true"></div>
        <p>Escanea tu c&oacute;digo QR para entrar r&aacute;pido.</p>
      </div>
    </div>

    <div class="login-panel" data-panel="registro">
      <form class="registro-form" id="registroForm">
        <div class="form-grid">
          <div>
            <label>Nombre completo</label>
            <input type="text" name="nombre" placeholder="Don Jorge" required>
          </div>
          <div>
            <label>Nombre del negocio</label>
            <input type="text" name="negocio" placeholder="Tienda La Esquina" required>
          </div>
          <div>
            <label>Direcci&oacute;n</label>
            <input type="text" name="direccion" placeholder="Carrera, barrio, municipio" required>
          </div>
          <div>
            <label>Observaciones de entrega</label>
            <textarea name="observaciones" rows="3" placeholder="Casa con puertas rojas, al lado de..."></textarea>
          </div>
          <div>
            <label>Correo</label>
            <input type="email" name="correoRegistro" placeholder="correo@negocio.com" required>
          </div>
          <div>
            <label>Contrase&ntilde;a</label>
            <input type="password" name="passwordRegistro" placeholder="Crea tu contrase&ntilde;a" required>
          </div>
          <div>
            <label>Fecha de cumplea&ntilde;os</label>
            <input type="text" name="cumple" placeholder="DD/MM" inputmode="numeric" maxlength="5">
          </div>
          <div>
            <label>M&eacute;todo de pago preferido</label>
            <select name="pago">
              <option value="Nequi">Nequi</option>
              <option value="Bancolombia">Bancolombia</option>
              <option value="Efectivo">Efectivo</option>
              <option value="Transferencia">Transferencia</option>
            </select>
          </div>
          <div>
            <label>WhatsApp</label>
            <input type="tel" name="telefono" placeholder="+57 3xx xxx xxxx">
          </div>
        </div>
        <button type="submit" class="btn-primary">Crear cuenta</button>
        <small class="form-note">Recuerda tu contrase&ntilde;a. Guardamos direcci&oacute;n, observaciones y m&eacute;todo de pago para pedidos r&aacute;pidos.</small>
      </form>
    </div>
    <div class="login-footer">
      <button type="button" class="logout-modal">Salir de la cuenta</button>
    </div>
  </div>
</div>


<script>
/* ===== SLIDER DE IMAGENES ===== */



/* ===== MENSAJES DE BIENVENIDA ===== */
let mensajes = document.querySelectorAll(".mensaje");
let mensajeIndex = 0;

function cambiarMensaje(){
    mensajes[mensajeIndex].classList.remove("activo");
    mensajeIndex = (mensajeIndex + 1) % mensajes.length;
    mensajes[mensajeIndex].classList.add("activo");
}
const btnTop = document.querySelector('.btn-top');
    if(btnTop){
        btnTop.addEventListener('click', e => {
            e.preventDefault();
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }
setInterval(cambiarMensaje, 5000); // tipo periodico
/* ===== SLIDER PERILLA (MOUSE) ===== */
const slider = document.querySelector('.slider');

if (slider) {
    let autoDir = 1;
    let autoRun = true;
    let lastTime = performance.now();
    const speed = 30; // px por segundo
    let acc = 0;
    let resumeTimer;

    const update = (time) => {
        const delta = time - lastTime;
        lastTime = time;
        if (!autoRun) return;
        acc += autoDir * (speed * delta / 1000);
        const move = acc > 0 ? Math.floor(acc) : Math.ceil(acc);
        if (move !== 0) {
            slider.scrollLeft += move;
            acc -= move;
        }
        if (slider.scrollLeft + slider.clientWidth >= slider.scrollWidth - 2) {
            autoDir = -1;
        } else if (slider.scrollLeft <= 0) {
            autoDir = 1;
        }
    };

    const isIOS = /iP(ad|hone|od)/.test(navigator.userAgent);
    if (isIOS) {
        slider.style.scrollBehavior = 'auto';
        setInterval(() => update(performance.now()), 30);
    } else {
        const step = (time) => {
            update(time);
            requestAnimationFrame(step);
        };
        requestAnimationFrame(step);
    }

    const pauseAuto = () => {
        autoRun = false;
        clearTimeout(resumeTimer);
        resumeTimer = setTimeout(() => autoRun = true, 1200);
    };

    slider.addEventListener('mouseenter', pauseAuto);
    slider.addEventListener('mouseleave', () => autoRun = true);
    slider.addEventListener('touchstart', pauseAuto, { passive: true });
    slider.addEventListener('touchend', () => autoRun = true);
    slider.addEventListener('touchcancel', () => autoRun = true);

    slider.addEventListener('mousemove', (e) => {
        const rect = slider.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const percent = x / rect.width;
        slider.scrollLeft = (slider.scrollWidth - rect.width) * percent;
    });
}

// Dropdown categorias (tap en movil)
const categoriasDropdown = document.querySelector('.dropdown');
const categoriasBtn = document.querySelector('.btn-categorias');
if (categoriasDropdown && categoriasBtn) {
    const toggleCategorias = () => {
        categoriasDropdown.classList.toggle('open');
        const expanded = categoriasDropdown.classList.contains('open');
        categoriasBtn.setAttribute('aria-expanded', expanded ? 'true' : 'false');
    };

    categoriasBtn.addEventListener('click', (e) => {
        e.preventDefault();
        toggleCategorias();
    });
    categoriasBtn.addEventListener('touchstart', (e) => {
        e.preventDefault();
        e.stopPropagation();
        toggleCategorias();
    }, { passive: false });

    document.addEventListener('click', (e) => {
        if (!categoriasDropdown.contains(e.target)) {
            categoriasDropdown.classList.remove('open');
            categoriasBtn.setAttribute('aria-expanded', 'false');
        }
    });
}

// Pausa franja al tocar
const pausaEnTouch = (selector) => {
    const el = document.querySelector(selector);
    if (!el) return;
    el.addEventListener('touchstart', () => el.classList.add('pausa'), { passive: true });
    el.addEventListener('touchend', () => el.classList.remove('pausa'), { passive: true });
    el.addEventListener('touchcancel', () => el.classList.remove('pausa'), { passive: true });
};
pausaEnTouch('.franja-movimiento');
pausaEnTouch('.marquee-pagos');

// Modo nocturno
const themeToggle = document.querySelector(".modo-nocturno");
const themeIcon = themeToggle ? themeToggle.querySelector("i") : null;
const setTheme = (isDark) => {
    document.body.classList.toggle("dark", isDark);
    if (themeToggle) themeToggle.classList.toggle("active", isDark);
    if (themeIcon) {
        themeIcon.classList.toggle("fa-moon", !isDark);
        themeIcon.classList.toggle("fa-sun", isDark);
        themeIcon.classList.toggle("fa-solid", !isDark);
        themeIcon.classList.toggle("fa-regular", isDark);
    }
    localStorage.setItem("tema", isDark ? "dark" : "light");
};

const storedTheme = localStorage.getItem("tema");
if (storedTheme) setTheme(storedTheme === "dark");

if (themeToggle) {
    themeToggle.addEventListener("click", (e) => {
        e.preventDefault();
        setTheme(!document.body.classList.contains("dark"));
    });
}

// Modal login / registro
const loginModal = document.getElementById("loginModal");
const loginTriggers = document.querySelectorAll(".login");
const loginClose = loginModal ? loginModal.querySelector(".login-close") : null;
const loginOverlay = loginModal ? loginModal.querySelector(".login-overlay") : null;
const loginTabs = loginModal ? loginModal.querySelectorAll(".login-tab") : [];
const loginPanels = loginModal ? loginModal.querySelectorAll(".login-panel") : [];
const qrBtn = loginModal ? loginModal.querySelector(".btn-social.qr") : null;
const qrPanel = loginModal ? loginModal.querySelector("#qrPanel") : null;

const openLogin = () => {
    if (!loginModal) return;
    loginModal.classList.add("open");
    loginModal.setAttribute("aria-hidden", "false");
    document.body.classList.add("modal-open");
};
const closeLogin = () => {
    if (!loginModal) return;
    loginModal.classList.remove("open");
    loginModal.setAttribute("aria-hidden", "true");
    document.body.classList.remove("modal-open");
};

loginTriggers.forEach((btn) => {
    btn.addEventListener("click", (e) => {
        e.preventDefault();
        openLogin();
    });
});
if (loginClose) loginClose.addEventListener("click", closeLogin);
if (loginOverlay) loginOverlay.addEventListener("click", closeLogin);
document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closeLogin();
});

loginTabs.forEach((tab) => {
    tab.addEventListener("click", () => {
        const target = tab.dataset.tab;
        loginTabs.forEach((t) => t.classList.remove("active"));
        tab.classList.add("active");
        loginPanels.forEach((p) => {
            p.classList.toggle("active", p.dataset.panel === target);
        });
    });
});

if (qrBtn && qrPanel) {
    qrBtn.addEventListener("click", () => {
        qrPanel.classList.toggle("open");
    });
}

const USER_KEY = "du_cliente";
const loginGreeting = loginModal ? loginModal.querySelector(".login-greeting") : null;
const greetLine = loginModal ? loginModal.querySelector(".greet-line") : null;
const greetSub = loginModal ? loginModal.querySelector(".greet-sub") : null;
const logoutBtns = document.querySelectorAll(".logout-modal");
const logoutHeaderBtns = document.querySelectorAll(".logout-header");
const bannerGreeting = document.querySelector(".saludo-banner");
const bannerLine = bannerGreeting ? bannerGreeting.querySelector(".saludo-banner-line") : null;
const bannerText = bannerGreeting ? bannerGreeting.querySelector(".saludo-banner-text") : null;
const loginForm = document.getElementById("loginForm");
const rutaTextEls = document.querySelectorAll(".ruta-text");
let greetTimer;
let bannerTimer;
let rutaTimer;

const updateUserUI = (user) => {
    const isLogged = !!(user && user.loggedIn);
    const name = isLogged && user.nombre ? user.nombre : null;
    const direccion = isLogged && user.direccion ? user.direccion : "";
    clearInterval(greetTimer);
    clearInterval(bannerTimer);
    clearInterval(rutaTimer);
    if (isLogged && name) {
        document.body.classList.add("logged-in");
        logoutBtns.forEach((el) => el.style.display = "inline-flex");
        logoutHeaderBtns.forEach((el) => el.style.display = "inline-flex");
        if (loginGreeting && greetLine && greetSub) {
            loginGreeting.classList.add("show");
            greetLine.textContent = `¡Bienvenido, ${name}!`;
            const mensajes = [
                `¿Qué tal va tu día, ${name}?`,
                `Listos para tu pedido, ${name}.`,
                `Cuenta con nosotros hoy, ${name}.`
            ];
            let i = 0;
            greetSub.textContent = mensajes[i];
            greetTimer = setInterval(() => {
                i = (i + 1) % mensajes.length;
                greetSub.textContent = mensajes[i];
            }, 3500);
        }
        if (bannerGreeting && bannerLine && bannerText) {
            bannerGreeting.classList.add("show");
            bannerLine.textContent = `Hola, ${name}`;
            const mensajesBanner = [
                `¡Qué gusto verte, ${name}!`,
                direccion ? `Sabemos tu ubicación: ${direccion}` : "Estamos listos para tu pedido.",
                `Si llueve, igual llegamos: tu pedido está seguro.`,
                `Pedidos rápidos y con cariño, ${name}.`
            ];
            let j = 0;
            bannerText.textContent = mensajesBanner[j];
            bannerTimer = setInterval(() => {
                bannerText.classList.add("fade");
                setTimeout(() => {
                    j = (j + 1) % mensajesBanner.length;
                    bannerText.textContent = mensajesBanner[j];
                    bannerText.classList.remove("fade");
                }, 300);
            }, 3200);
        }
        if (rutaTextEls.length) {
            const rutaMensajes = [
                "Rutas activas esta semana: martes y viernes.",
                "Actualizamos las rutas cada lunes.",
                "Si tu zona cambia, te avisamos por aquí."
            ];
            let r = 0;
            rutaTextEls.forEach((el) => el.textContent = rutaMensajes[r]);
            rutaTimer = setInterval(() => {
                rutaTextEls.forEach((el) => el.classList.add("fade"));
                setTimeout(() => {
                    r = (r + 1) % rutaMensajes.length;
                    rutaTextEls.forEach((el) => {
                        el.textContent = rutaMensajes[r];
                        el.classList.remove("fade");
                    });
                }, 300);
            }, 4200);
        }
    } else {
        document.body.classList.remove("logged-in");
        logoutBtns.forEach((el) => el.style.display = "none");
        logoutHeaderBtns.forEach((el) => el.style.display = "none");
        if (loginGreeting) loginGreeting.classList.remove("show");
        if (bannerGreeting) bannerGreeting.classList.remove("show");
        rutaTextEls.forEach((el) => el.classList.remove("fade"));
    }
};

const fillLoginFromUser = (user) => {
    if (!loginForm || !user) return;
    if (user.correo) loginForm.correo.value = user.correo;
    if (user.clave) loginForm.password.value = user.clave;
};

const storedUser = localStorage.getItem(USER_KEY);
if (storedUser) {
    try {
        const parsed = JSON.parse(storedUser);
        fillLoginFromUser(parsed);
        updateUserUI(parsed);
    } catch (e) {
        localStorage.removeItem(USER_KEY);
    }
}

if (loginForm) {
    loginForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const correo = loginForm.correo.value.trim();
        let user = { nombre: "Cliente", correo: correo, clave: loginForm.password.value.trim(), loggedIn: true };
        const saved = localStorage.getItem(USER_KEY);
        if (saved) {
            try { user = JSON.parse(saved); } catch (err) {}
            user.correo = correo || user.correo;
            user.clave = loginForm.password.value.trim() || user.clave;
            user.loggedIn = true;
        } else if (correo && correo.includes("@")) {
            user.nombre = correo.split("@")[0];
        }
        localStorage.setItem(USER_KEY, JSON.stringify(user));
        updateUserUI(user);
        closeLogin();
    });
}

const registroForm = document.getElementById("registroForm");
if (registroForm) {
    registroForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const user = {
            nombre: registroForm.nombre.value.trim() || "Cliente",
            negocio: registroForm.negocio.value.trim(),
            direccion: registroForm.direccion.value.trim(),
            observaciones: registroForm.observaciones.value.trim(),
            correo: registroForm.correoRegistro.value.trim(),
            clave: registroForm.passwordRegistro.value.trim(),
            cumple: registroForm.cumple.value.trim(),
            pago: registroForm.pago.value,
            telefono: registroForm.telefono.value.trim(),
            loggedIn: true
        };
        localStorage.setItem(USER_KEY, JSON.stringify(user));
        fillLoginFromUser(user);
        updateUserUI(user);
        closeLogin();
    });
}

logoutBtns.forEach((btn) => {
    btn.addEventListener("click", (e) => {
        e.preventDefault();
        const saved = localStorage.getItem(USER_KEY);
        if (saved) {
            try {
                const user = JSON.parse(saved);
                user.loggedIn = false;
                localStorage.setItem(USER_KEY, JSON.stringify(user));
                updateUserUI(user);
            } catch (err) {
                localStorage.removeItem(USER_KEY);
                updateUserUI(null);
            }
        } else {
            updateUserUI(null);
        }
    });
});
logoutHeaderBtns.forEach((btn) => {
    btn.addEventListener("click", (e) => {
        e.preventDefault();
        const saved = localStorage.getItem(USER_KEY);
        if (saved) {
            try {
                const user = JSON.parse(saved);
                user.loggedIn = false;
                localStorage.setItem(USER_KEY, JSON.stringify(user));
                updateUserUI(user);
            } catch (err) {
                localStorage.removeItem(USER_KEY);
                updateUserUI(null);
            }
        } else {
            updateUserUI(null);
        }
    });
});

</script>


</body>
</html>



